{% extends "_base.html" %}
{% load static %}

{% block headerstatic %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.9.0/css/bootstrap-slider.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.9.0/bootstrap-slider.js"></script>

  <link rel="stylesheet" href="{% static 'css/ui.css' %}">
  <link rel="stylesheet" href="{% static 'css/map.css' %}">
  <script>
  //Declared global variable here so that it may be referred to by other scripts
    function initMap (){};
  </script>
  <script type="text/javascript" src="{% url 'visualize:map' %}" ></script>

  <script defer
    src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLEMAPS_SECRET_KEY }}&libraries=visualization&callback=initMap&region=SG">
  </script>
{% endblock %}

{% block header %}Visualize{% endblock %}
{% block content %}
{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
<!-- Stats -->


  <div id="floating-panel">
    <table>
        <tr>
    <button onclick="toggleHeatmap()">Toggle Heatmap</button>
    <button onclick="changeGradient()">Change gradient</button>
    <button onclick="changeRadius()">Change radius</button>
    <button onclick="changeOpacity()">Change opacity</button>
    <button onclick="showNearby()">Show near-by taxis</button>
        </tr>
        <tr>
        <th><div>Average distance away of taxis within 500m:</div><div id="average_dist">"-"</div></th>
        <th><div>Number of taxis within 500m:</div><div id="num">"-"</div></th>
    </tr>
    </table>
  </div>

  <!-- Slider: zero is now, positive is future. -->
  <div>
    <input type="range" id="genTime" data-slider-id="genTimeSlider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0">
    <script defer type='text/javascript'>
      $('#genTime').slider({
          formatter: function (value) {
              return value;
          }
      }).on('{{ SLIDE_EVENT }}', genTimeSliderChange);
    </script>
  </div>

  <div>
    <input type="range" id="genHeatmap" data-slider-id="genHeatmapSlider" type="text" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0">
    <script defer type='text/javascript'>
      $('#genHeatmap').slider({
          formatter: function (value) {
              return value;
          }
      }).on('{{ SLIDE_EVENT }}', genHeatmapSliderChange);
    </script>
  </div>

  <div id= "map-all">
      <!-- Google maps. -->
      <div id="map"></div>

      <!--SVG for charts -->
      <div id="container-chart" >
      <svg class="chart"></svg>
      </div>
  </div>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
  #container-chart {
      padding:10px;
      height:20%;
      width:20%;
      position: absolute;
      top: 0px;
      right: 0px;

  }
  #map-all {
      position:relative;
      height: 100%;
      width: 100%;
  }
  </style>


{% endblock %}
