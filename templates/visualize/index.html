{% extends "_base.html" %}
{% load static %}
{% block headerstatic %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.9.0/css/bootstrap-slider.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.9.0/bootstrap-slider.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
<link rel="stylesheet" href="{% static 'css/ui.css' %}">
<link rel="stylesheet" href="{% static 'css/map.css' %}">
<script>
    //Declared global variable here so that it may be referred to by other scripts
      function initMap (){};
</script>
<script type="text/javascript" src="{% url 'visualize:map' %}" ></script>
<script defer
    src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLEMAPS_SECRET_KEY }}&libraries=visualization,places&callback=initMap&region=SG"></script>
{% endblock %}
{% block content %}
<div id= "map-all">
    <!-- Google maps. -->
    <div id="map"></div>
    <!-- Stats -->
    <div id="floating-panel">
        <table>
            <tr>
                <button onclick="toggleHeatmap()">Toggle Heatmap</button>
                <button onclick="changeGradient()">Change gradient</button>
                <button onclick="changeRadius()">Change radius</button>
                <button onclick="changeOpacity()">Change opacity</button>
                <button onclick="showNearby()">Show near-by taxis</button>
            </tr>
            <tr>
                <th>
                    <div>Average distance away of taxis within 500m:</div>
                    <div id="average_dist">"-"</div>
                </th>
                <th>
                    <div>Number of taxis within 500m:</div>
                    <div id="num">"-"</div>
                </th>
            </tr>
        </table>
    </div>
    <script defer type="text/javascript" src="{% url 'visualize:slider' %}" ></script>
    <div class="container">
        {% if error_message %}
        <p><strong>{{ error_message }}</strong></p>
        {% endif %}
        <div class='col-sm-6'>
            <input type="range" id="genTime" data-slider-id="genTimeSlider" type="text" data-slider-min="0" data-slider-max="60" data-slider-step="1" data-slider-value="0" data-slider-reversed="true"><br>
            <input type="range" id="genHeatmap" data-slider-id="genHeatmapSlider" type="text" data-slider-min="0" data-slider-max="60" data-slider-step="1" data-slider-value="0" data-slider-reversed="true"><br>
            <input type="range" id="genHeatmapIntensity" data-slider-id="genHeatmapIntensitySlider" type="text" data-slider-min="1" data-slider-max="10" data-slider-step="1" data-slider-value="0"><br>
            <div class='input-group date' id='datetimepicker'>
                <input type='text' class="form-control"/>
                <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span>
                </span>
            </div>
        </div>
    </div>
    <!-- UI -->
    <div class = "sidewindow">
        <input type="button" id="addRow" value="Add new row">
        <table id="itineraryTable">
            <thead>
                <tr>
                    <th>Location</th>
                    <th>Time</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <!--SVG for charts -->
    <div id="container-chart" >
        <svg class="chart"></svg>
    </div>
</div>
<script src="https://d3js.org/d3.v4.min.js"></script>
<style>
    #container-chart {
    padding:10px;
    height:20%;
    width:20%;
    position: absolute;
    bottom: 0px;
    right: 0px;
    }
    #map-all {
    position:fixed;
    height: 100%;
    width: 100%;
    }
</style>
{% endblock %}
