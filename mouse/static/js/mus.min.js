!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.Mus=i()}(this,function(){"use strict";function t(){void 0!==this?(this.frames=[],this.timeouts=[],this.pos=0,this.currPos=0,this.startedAt=0,this.finishedAt=0,this.recording=!1,this.playing=!1,this.playbackSpeed=this.speed.NORMAL,this.window={width:window.outerWidth,height:window.outerHeight},this.onmousemove=window.onmousemove,this.onmousedown=window.onmousedown,this.onscroll=window.onscroll):console.error('Have you initialized Mus with "new" statement? (i.e. var mus = new Mus())')}return t.prototype={moveListener:function(t){return function(i){t&&t(["m",i.clientX,i.clientY])}},clickListener:function(t){return function(i){t&&t(["c",i.clientX,i.clientY])}},scrollListener:function(t){return function(i){t&&t(["s",document.scrollingElement.scrollLeft,document.scrollingElement.scrollTop])}},record:function(){if(!this.recording){var t=this;0==t.startedAt&&(t.startedAt=(new Date).getTime()/1e3),t.frames.push(["s",document.scrollingElement.scrollLeft,document.scrollingElement.scrollTop]),window.onmousemove=this.moveListener(function(i){t.frames.push(i)}),window.onmousedown=this.clickListener(function(i){t.frames.push(i)}),window.onscroll=this.scrollListener(function(i){t.frames.push(i)}),t.recording=!0}},stop:function(){this.finishedAt=(new Date).getTime()/1e3,window.onmousemove=this.onmousemove,window.onmousedown=this.onmousedown,window.onscroll=this.onscroll,this.timeouts=[],this.recording=!1,this.playing=!1,this.pos=0},pause:function(){this.playing&&(this.pos=this.currPos,this.playing=!1,this.clearTimeouts())},play:function(t){if(!this.playing){var i=this;i.createCursor();for(var e=document.getElementById("musCursor");i.pos<i.frames.length;i.pos++)i.timeouts.push(setTimeout(function(o){i.playFrame(i,i.frames[o],e),i.currPos=o,o==i.frames.length-1&&(e.style.backgroundColor="transparent",i.timeouts=[],i.playing=!1,i.pos=0,t&&t())},i.pos*i.playbackSpeed,i.pos));this.playing=!0}},release:function(){this.frames=[],this.startedAt=0,this.finishedAt=0,this.stop(),this.destroyCursor(),this.destroyClickSnapshot()},playFrame:function(t,i,e){"m"==i[0]?(e.style.left=t.getXCoordinate(i[1])+"px",e.style.top=t.getYCoordinate(i[2])+"px"):"c"==i[0]?t.createClickSnapshot(i[2],i[1]):"s"==i[0]&&window.scrollTo(i[1],i[2])},clearTimeouts:function(){for(var t in this.timeouts)clearTimeout(this.timeouts[t]);this.timeouts=[]},timeElapsed:function(){return this.finishedAt-this.startedAt},createCursor:function(){if(!document.getElementById("musCursor")){var t=document.createElement("div");t.id="musCursor",t.style.position="fixed",t.style.width="32px",t.style.height="32px",t.style.top="-100%",t.style.left="-100%",t.style.borderRadius="32px",t.style.backgroundImage="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCSB2aWV3Qm94PSIwIDAgMjggMjgiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI4IDI4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBwb2ludHM9IjguMiwyMC45IDguMiw0LjkgMTkuOCwxNi41IDEzLDE2LjUgMTIuNiwxNi42ICIvPjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHBvaW50cz0iMTcuMywyMS42IDEzLjcsMjMuMSA5LDEyIDEyLjcsMTAuNSAiLz48cmVjdCB4PSIxMi41IiB5PSIxMy42IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjkyMjEgLTAuMzg3MSAwLjM4NzEgMC45MjIxIC01Ljc2MDUgNi41OTA5KSIgd2lkdGg9IjIiIGhlaWdodD0iOCIvPjxwb2x5Z29uIHBvaW50cz0iOS4yLDcuMyA5LjIsMTguNSAxMi4yLDE1LjYgMTIuNiwxNS41IDE3LjQsMTUuNSAiLz48L3N2Zz4=)",document.body.appendChild(t)}},destroyCursor:function(){var t=document.getElementById("musCursor");t&&t.remove()},createClickSnapshot:function(t,i){var e=document.scrollingElement.scrollLeft,o=document.scrollingElement.scrollTop,s=document.createElement("div");s.className="musClickSnapshot",s.style.position="absolute",s.style.width="32px",s.style.height="32px",s.style.top=t+o+"px",s.style.left=i+e+"px",s.style.borderRadius="32px",s.style.backgroundColor="red",s.style.opacity=.2,document.body.appendChild(s)},destroyClickSnapshot:function(){for(var t=document.getElementsByClassName("musClickSnapshot");t.length>0;)t[0].remove()},getXCoordinate:function(t){return window.outerWidth>this.window.width?parseInt(this.window.width*t/window.outerWidth):parseInt(window.outerWidth*t/this.window.width)},getYCoordinate:function(t){return window.outerHeight>this.window.height?parseInt(this.window.height*t/window.outerHeight):parseInt(window.outerHeight*t/this.window.height)},getData:function(){return{frames:this.frames,timeElapsed:this.timeElapsed(),window:{width:window.outerWidth,height:window.outerHeight}}},setData:function(t){t.frames&&(this.frames=t.frames),t.window&&(this.window=t.window)},setFrames:function(t){this.frames=t},setWindowSize:function(t,i){this.window.width=t,this.window.height=i},setPlaybackSpeed:function(t){this.playbackSpeed=t},isRecording:function(){return this.recording},isPlaying:function(){return this.playing},speed:{SLOW:35,NORMAL:15,FAST:5}},t});